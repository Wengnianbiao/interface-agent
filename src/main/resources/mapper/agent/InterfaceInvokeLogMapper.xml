<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.helianhealth.agent.mapper.agent.InterfaceInvokeLogMapper">

    <resultMap id="InterfaceInvokeLogResultMap" type="com.helianhealth.agent.model.domain.InterfaceInvokeLogDO">
        <id property="logId" column="log_id"/>
        <result property="nodeId" column="node_id"/>
        <result property="businessData" column="business_data"/>
        <result property="paramBeforeInvoke" column="param_before_invoke"/>
        <result property="remoteInvokeResponse" column="remote_invoke_response"/>
        <result property="paramAfterInvoke" column="param_after_invoke"/>
        <result property="invokeTime" column="invoke_time"/>
        <result property="createTime" column="create_time"/>
    </resultMap>

    <insert id="insertLog" parameterType="com.helianhealth.agent.model.domain.InterfaceInvokeLogDO">
        INSERT INTO interface_invoke_log
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="nodeId != null">
                node_id,
            </if>
            <if test="businessData != null">
                business_data,
            </if>
            <if test="paramBeforeInvoke != null">
                param_before_invoke,
            </if>
            <if test="remoteInvokeResponse != null">
                remote_invoke_response,
            </if>
            <if test="paramAfterInvoke != null">
                param_after_invoke,
            </if>
            <if test="invokeTime != null">
                invoke_time,
            </if>
            <if test="createTime != null">
                create_time,
            </if>
        </trim>
        <trim prefix="VALUES (" suffix=")" suffixOverrides=",">
            <if test="nodeId != null">
                #{nodeId,jdbcType=INTEGER},
            </if>
            <if test="businessData != null">
                #{businessData,jdbcType=VARCHAR},
            </if>
            <if test="paramBeforeInvoke != null">
                #{paramBeforeInvoke,jdbcType=VARCHAR},
            </if>
            <if test="remoteInvokeResponse != null">
                #{remoteInvokeResponse,jdbcType=VARCHAR},
            </if>
            <if test="paramAfterInvoke != null">
                #{paramAfterInvoke,jdbcType=VARCHAR},
            </if>
            <if test="invokeTime != null">
                #{invokeTime,jdbcType=VARCHAR},
            </if>
            <if test="createTime != null">
                #{createTime,jdbcType=TIMESTAMP},
            </if>
        </trim>
    </insert>

    <select id="selectAllInvokeLogs" resultMap="InterfaceInvokeLogResultMap">
        select *
        from interface_invoke_log
        <where>
            <if test="nodeId != null">
                node_id = #{nodeId}
            </if>
        </where>
        ORDER BY create_time DESC
    </select>

</mapper>
